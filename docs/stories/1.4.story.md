# Story 1.4: Core Layout & Navigation

## Status

**Draft**

---

## Story

**As a** user,
**I want** a consistent navigation structure across all pages,
**so that** I can easily move between features of the app.

---

## Acceptance Criteria

1. App layout with header, main content area, and mobile navigation
2. RetroUI styling applied to all layout components
3. Header displays TRIBE logo, language switcher, and user menu
4. Mobile-responsive hamburger menu for navigation
5. Navigation links to: Dashboard, Q&A, Audio Briefings, Profile
6. Active route highlighted in navigation
7. Footer with minimal branding (optional for MVP)

---

## Tasks / Subtasks

- [ ] **Task 1: Create Header Component** (AC: 2, 3)
  - [ ] Create `components/layout/Header.tsx`
  - [ ] Add TRIBE logo/wordmark (text-based for MVP)
  - [ ] Integrate LanguageSwitcher from Story 1.3
  - [ ] Integrate UserMenu from Story 1.2
  - [ ] Apply RetroUI styling: bold borders, neobrutalist aesthetic
  - [ ] Make header sticky on scroll

- [ ] **Task 2: Create Desktop Navigation** (AC: 5, 6)
  - [ ] Create `components/layout/DesktopNav.tsx`
  - [ ] Add navigation links: Dashboard, Q&A, Audio, Settings
  - [ ] Use `usePathname()` to detect active route
  - [ ] Highlight active link with distinct style (bold border, background)
  - [ ] Use translation keys for all labels

- [ ] **Task 3: Create Mobile Navigation** (AC: 4)
  - [ ] Create `components/layout/MobileNav.tsx`
  - [ ] Hamburger menu button visible on mobile only
  - [ ] Slide-out or dropdown menu with same links as desktop
  - [ ] Close menu on navigation or outside click
  - [ ] Animate open/close with Framer Motion (optional)

- [ ] **Task 4: Create Dashboard Layout** (AC: 1)
  - [ ] Create `app/[locale]/(dashboard)/layout.tsx`
  - [ ] Include Header at top
  - [ ] Main content area with proper padding
  - [ ] Optional: Sidebar for desktop (can be added later)
  - [ ] Responsive: single column on mobile, flexible on desktop

- [ ] **Task 5: Create Footer Component** (AC: 7)
  - [ ] Create `components/layout/Footer.tsx`
  - [ ] Minimal content: "TRIBE © 2025" or similar
  - [ ] Optional: link to privacy/terms (placeholder)
  - [ ] Stick to bottom or after content

- [ ] **Task 6: Apply RetroUI Styling Throughout** (AC: 2)
  - [ ] Ensure consistent border-width (4px black borders)
  - [ ] Shadow style: `shadow-[4px_4px_0_0_#000]`
  - [ ] Button styles: chunky, bold
  - [ ] Color palette: high contrast, accessible
  - [ ] Typography: clear, readable

- [ ] **Task 7: Create Dashboard Placeholder Page** (AC: 5)
  - [ ] Update `app/[locale]/(dashboard)/dashboard/page.tsx`
  - [ ] Display welcome message with user name
  - [ ] Placeholder cards for: Corridor, Protocols, Quick Actions
  - [ ] Use RetroUI Card components

- [ ] **Task 8: Add Navigation Translations** (AC: 5)
  - [ ] Add navigation keys to all 5 locale files
  - [ ] Keys: dashboard, chat, audio, settings, signOut
  - [ ] Verify translations display correctly

---

## Dev Notes

### RetroUI Styling Patterns
[Source: architecture.md#tech-stack, PRD#3.5]

```css
/* Neobrutalist style patterns */
.retro-card {
  @apply border-4 border-black shadow-[4px_4px_0_0_#000] bg-white;
}

.retro-button {
  @apply border-4 border-black px-4 py-2 font-bold
         hover:translate-x-[2px] hover:translate-y-[2px]
         hover:shadow-[2px_2px_0_0_#000]
         transition-all;
}

.retro-active {
  @apply bg-black text-white;
}
```

### Header Component Structure
[Source: architecture.md#components]

```typescript
// components/layout/Header.tsx
"use client";

import Link from "next/link";
import { useTranslations } from "next-intl";
import { LanguageSwitcher } from "./LanguageSwitcher";
import { UserMenu } from "./UserMenu";
import { MobileNav } from "./MobileNav";
import { DesktopNav } from "./DesktopNav";

export function Header() {
  const t = useTranslations("navigation");

  return (
    <header className="sticky top-0 z-50 border-b-4 border-black bg-white">
      <div className="container mx-auto flex items-center justify-between px-4 py-3">
        {/* Logo */}
        <Link href="/" className="text-2xl font-black tracking-tight">
          TRIBE
        </Link>

        {/* Desktop Navigation */}
        <DesktopNav className="hidden md:flex" />

        {/* Right side: Language + User */}
        <div className="flex items-center gap-4">
          <LanguageSwitcher />
          <UserMenu />
          <MobileNav className="md:hidden" />
        </div>
      </div>
    </header>
  );
}
```

### Navigation Links Configuration
[Source: PRD#3.3]

```typescript
// lib/navigation.ts
export const navLinks = [
  { href: "/dashboard", labelKey: "dashboard", icon: "home" },
  { href: "/dashboard/chat", labelKey: "chat", icon: "message" },
  { href: "/dashboard/audio", labelKey: "audio", icon: "headphones" },
  { href: "/settings", labelKey: "settings", icon: "settings" },
] as const;
```

### Active Route Detection
[Source: architecture.md#routing-architecture]

```typescript
// components/layout/DesktopNav.tsx
"use client";

import Link from "next/link";
import { usePathname } from "next/navigation";
import { useTranslations } from "next-intl";
import { navLinks } from "@/lib/navigation";

export function DesktopNav({ className }: { className?: string }) {
  const pathname = usePathname();
  const t = useTranslations("navigation");

  const isActive = (href: string) => {
    // Remove locale prefix for comparison
    const pathWithoutLocale = pathname.replace(/^\/[a-z]{2}/, "");
    return pathWithoutLocale === href || pathWithoutLocale.startsWith(href + "/");
  };

  return (
    <nav className={className}>
      <ul className="flex gap-2">
        {navLinks.map((link) => (
          <li key={link.href}>
            <Link
              href={link.href}
              className={`border-4 border-black px-4 py-2 font-bold transition-all
                ${isActive(link.href)
                  ? "bg-black text-white"
                  : "bg-white hover:bg-gray-100"
                }`}
            >
              {t(link.labelKey)}
            </Link>
          </li>
        ))}
      </ul>
    </nav>
  );
}
```

### Mobile Navigation Pattern
[Source: architecture.md#frontend-architecture]

```typescript
// components/layout/MobileNav.tsx
"use client";

import { useState } from "react";
import Link from "next/link";
import { usePathname } from "next/navigation";
import { useTranslations } from "next-intl";
import { navLinks } from "@/lib/navigation";

export function MobileNav({ className }: { className?: string }) {
  const [isOpen, setIsOpen] = useState(false);
  const pathname = usePathname();
  const t = useTranslations("navigation");

  return (
    <div className={className}>
      {/* Hamburger Button */}
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="border-4 border-black p-2"
        aria-label="Toggle menu"
      >
        <span className="block w-6 h-0.5 bg-black mb-1.5" />
        <span className="block w-6 h-0.5 bg-black mb-1.5" />
        <span className="block w-6 h-0.5 bg-black" />
      </button>

      {/* Mobile Menu */}
      {isOpen && (
        <div className="absolute top-full left-0 right-0 border-b-4 border-black bg-white">
          <nav className="container mx-auto p-4">
            <ul className="flex flex-col gap-2">
              {navLinks.map((link) => (
                <li key={link.href}>
                  <Link
                    href={link.href}
                    onClick={() => setIsOpen(false)}
                    className="block border-4 border-black px-4 py-3 font-bold"
                  >
                    {t(link.labelKey)}
                  </Link>
                </li>
              ))}
            </ul>
          </nav>
        </div>
      )}
    </div>
  );
}
```

### Dashboard Layout
[Source: architecture.md#unified-project-structure]

```typescript
// app/[locale]/(dashboard)/layout.tsx
import { Header } from "@/components/layout/Header";
import { Footer } from "@/components/layout/Footer";

export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <div className="min-h-screen flex flex-col">
      <Header />
      <main className="flex-1 container mx-auto px-4 py-8">
        {children}
      </main>
      <Footer />
    </div>
  );
}
```

### Translation Keys to Add
```json
// Add to messages/{locale}.json
{
  "navigation": {
    "dashboard": "Dashboard",
    "chat": "Ask TRIBE",
    "audio": "Audio Briefings",
    "settings": "Settings"
  },
  "common": {
    "welcome": "Welcome back, {name}!",
    "loading": "Loading..."
  }
}
```

### File Structure
```
components/
└── layout/
    ├── Header.tsx
    ├── DesktopNav.tsx
    ├── MobileNav.tsx
    ├── Footer.tsx
    ├── LanguageSwitcher.tsx  (from Story 1.3)
    └── UserMenu.tsx          (from Story 1.2)

lib/
└── navigation.ts             # Nav link configuration

app/
└── [locale]/
    └── (dashboard)/
        ├── layout.tsx        # Dashboard layout with Header/Footer
        └── dashboard/
            └── page.tsx      # Dashboard home page
```

### Dependencies from Previous Stories
- Story 1.2: UserMenu component, authentication
- Story 1.3: LanguageSwitcher, translations, locale routing

---

## Testing

### Test Scenarios

1. **Header Display**
   - [ ] TRIBE logo visible and links to home
   - [ ] Language switcher works
   - [ ] User menu shows when authenticated

2. **Desktop Navigation**
   - [ ] All 4 nav links visible on desktop
   - [ ] Current page highlighted
   - [ ] Clicking link navigates correctly

3. **Mobile Navigation**
   - [ ] Hamburger visible on mobile viewport
   - [ ] Menu opens on click
   - [ ] Menu closes on link click
   - [ ] Menu closes on outside click

4. **Responsive Behavior**
   - [ ] Resize browser: desktop nav hides, mobile nav shows
   - [ ] Content remains readable at all sizes

5. **Active State**
   - [ ] Dashboard link highlighted on `/en/dashboard`
   - [ ] Q&A link highlighted on `/en/dashboard/chat`

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-21 | 1.0 | Initial story draft | Bob (SM) |

---

## Dev Agent Record

### Agent Model Used
*To be filled by Dev Agent*

### Debug Log References
*To be filled by Dev Agent*

### Completion Notes List
*To be filled by Dev Agent*

### File List
*To be filled by Dev Agent*

---

## QA Results
*To be filled by QA Agent*
